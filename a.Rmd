---
title: "teorema central del limite"
author: "Silv"
date: "2024-09-11"
output: html_document
---
Recordemos que el TCL nos dice, entre muchos otros resultados quie si se tiene una coleccion de "m" variales independientes e identicamente distribuidas (iid: cada variable es independiente  de las demas y todas provienen o son generadas por la misma distribucion de probabilidad), entonces el estadistico media muestra proviene asintoticamente de una distribucion normal con media "mu" (media poblacional) y varianza "sigma cuadrado divido m"
(varianza poblacional dividido la cantidad de vairables aleatorias).

Ademas, tambien nos provee la distribucion de probabilidad asintotica de otros estadistico muestrales como lo son la porporcion muestral y la varuaza muestral. A continuacion, realizaremos una simulacion para probar empiricamente que el TCL es cierto.

## Ejemplo 1: Probamos la distribucion de probabilidad d ela media muestra a partir de variables aleatorias que provienen de una distribucion normal 


```{r}
# 0) Definir poblacion de tamanio "N"

N = 10000

mu = 170

sigma = 10

Poblacion = rnorm(N, mu, sigma)


# 1) Generar esas "m" replicas/copias de la variables aleatoria, de tamano "n"

m = 10000
n = 1000
medias = rep(0, m)

for (i in 1:m){
  indicador = sample(1:N, n, replace = F) #Muestra i-esima  
  
  X = Poblacion[indicador] #Muestra generada
  
  medias[i] = mean(X)
  
}

a = sort(rnorm(10000, mu, sigma/sqrt(n)))

hist(medias, freq = F)


lines(a, dnorm(a, mu, sigma/sqrt(n)))

val.sam = c(mean(medias), var(medias))
val.teo = c(mu, (sigma^2)/n)

print(rbind(val.sam, val.teo))

```



```{r}


N = 10000
lambda = 15

mu = 1/lambda

sigma = 1/lambda



Poblacion = rexp(N,lambda)


# 1) Generar esas "m" replicas/copias de la variables aleatoria, de tamano "n"

m = 10000
n = 1000


medias = rep(0, m)

for (i in 1:m){
  indicador = sample(1:N, n, replace = F) #Muestra i-esima  
  
  X = Poblacion[indicador] #Muestra generada
  
  medias[i] = mean(X)
  
}

a = sort(rnorm(10000, mu, sigma/sqrt(n)))

hist(medias, freq = F)


lines(a, dnorm(a, mu, sigma/sqrt(n)))

val.sam = c(mean(medias), var(medias))
val.teo = c(mu, (sigma^2)/n)

print(rbind(val.sam, val.teo))


```








```{r}

N = 100000
p = 0.5

pob = rbinom(N, 1, p)


m = 10000
n = 1000
proporciones = rep(0, m)


for(i in i:m){
  ind = sample (1:N, m replace = F)
  muestra = poblacion[ind]
  proporciones[i] = mean(muestra)
}





```




```{r}

# Parámetros de la distribución
mu <- 170  # Media
sigma <- 2  # Desviación estándar

# Valores para el eje x
x <- seq(mu - 4 * sigma, mu + 4 * sigma, length.out = 1000)

# Función de densidad de probabilidad (curva normal)
y <- dnorm(x, mean = mu, sd = sigma)

# Crear la gráfica
plot(x, y, type = "l", lwd = 2, col = "blue", 
     main = "Distribución del Promedio Muestral", 
     xlab = "Promedio Muestral (cm)", 
     ylab = "Densidad de Probabilidad")

# Rellenar el área bajo la curva
polygon(c(x, rev(x)), c(y, rep(0, length(y))), col = rgb(0, 0, 1, 0.2), border = NA)

# Línea vertical en la media
abline(v = mu, col = "red", lty = 2, lwd = 2)

# Agregar leyenda
legend("topright", legend = expression(bar(x) ~ N(170, 2^2)), col = "blue", lwd = 2)
legend("topleft", legend = paste("Media =", mu, "cm"), col = "red", lty = 2, lwd = 2)

# Mostrar la cuadrícula
grid()

```


















